(self.webpackChunkarch_guide=self.webpackChunkarch_guide||[]).push([[414],{4909:(e,a,s)=>{"use strict";s.r(a),s.d(a,{data:()=>n});const n={key:"v-6e7a56da",path:"/advanced/debug.html",title:"常见问题排除与解决",lang:"zh-CN",frontmatter:{},excerpt:"",headers:[{level:3,title:"关机时卡住很久才能关机",slug:"关机时卡住很久才能关机",children:[]},{level:3,title:"磁盘容量不足的处理方式",slug:"磁盘容量不足的处理方式",children:[]},{level:3,title:"软件的降级",slug:"软件的降级",children:[]},{level:3,title:"升级系统时出现形如error: failed to update core (unable to lock database)的错误",slug:"升级系统时出现形如error-failed-to-update-core-unable-to-lock-database-的错误",children:[]},{level:3,title:"手动开关混成器",slug:"手动开关混成器",children:[]}],filePathRelative:"advanced/debug.md",git:{updatedTime:1622314155e3,contributors:[{name:"icekylin",email:"wminid@yeah.net",commits:1}]}}},79:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>f});var n=s(6252);const r=(0,n.uE)('<h1 id="常见问题排除与解决"><a class="header-anchor" href="#常见问题排除与解决">#</a> 常见问题排除与解决</h1><p>本结描述一些在日常使用过程中你很有可能遇到的问题，并提供解决方法。</p><h3 id="关机时卡住很久才能关机"><a class="header-anchor" href="#关机时卡住很久才能关机">#</a> 关机时卡住很久才能关机</h3><p>一般屏幕会出现形如<code>A stop job is running for...(1m30s)</code>的信息，这是经常会遇到的关机卡住 1 分 30 秒的问题，一般来说这种情况是出现了某个进程在关机时不愿停止，需要等到超时时间到达强行停止。通用的解决办法是调整缩短这个等待时间，建议从 1 分 30 秒调整至 30 秒，30 秒已经足够几乎所有进程正常结束。</p><p>编辑 <code>/etc/systemd/system.conf</code></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">vim</span> /etc/systemd/system.conf\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>找到其中<code>DefaultTimeoutStopSec</code>一项，将其前方的井号去掉，并赋值为 30s 即可。最后执行 daemon-reload 使其生效。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">sudo</span> systemctl daemon-reload\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>上述解决方案其实只是将这个等待时间缩小了，并没有解决实际问题。如果你想排查问题真正的原因所在，在关机时如果出现了<code>A stop job is running for...(1m30s)</code>的信息，耐心等待其结束关机，然后重新启动电脑，执行以下命令：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>journalctl -p5\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>按/(斜杠键)搜索<code>Killing</code>关键字，找到你关机的时间附近所在的匹配行，你可以在附近看到到底是哪一个进程导致了 timeout,然后再去排查这个进程有什么问题即可。</p>',11),o=(0,n.Uk)("ref: ["),l={href:"https://forum.manjaro.org/t/a-stop-job-is-running-for-user-manager-for-uid-1000-during-shutdown/37799",target:"_blank",rel:"noopener noreferrer"},d=(0,n.Uk)("1"),c=(0,n.Uk)("]["),t={href:"https://unix.stackexchange.com/questions/273876/a-stop-job-is-running-for-session-c2-of-user",target:"_blank",rel:"noopener noreferrer"},i=(0,n.Uk)("2"),u=(0,n.Uk)("]"),p=(0,n.uE)('<h3 id="磁盘容量不足的处理方式"><a class="header-anchor" href="#磁盘容量不足的处理方式">#</a> 磁盘容量不足的处理方式</h3><p>一般使用 LVM 安装 Linux 系统则不用担心这种情况发生。但是我们使用的是传统的 ext4 经典分区方式。这种情况下一般建议在安装的开始就将根目录设置的大一些，如 100G。如果/home 分区大小不够了，可以新安装一块硬盘，将其挂载到你想要的位置，再按照<code>基础安装</code>的步骤中重新 genfstab 一下就行了。</p><h3 id="软件的降级"><a class="header-anchor" href="#软件的降级">#</a> 软件的降级</h3><p>在 archlinux 上 偶尔会出现某一个包的最新版本有各种问题的情况，此时需要降级该包以正常使用，包可以是普通软件，也可以是内核。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>yay -S downgrade\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>安装此包即可，使用方法也很简单，downgrade 后加上需要降级的包名即可，随后会提示你选择需要降级到的版本，点选即可。</p><h3 id="升级系统时出现形如error-failed-to-update-core-unable-to-lock-database-的错误"><a class="header-anchor" href="#升级系统时出现形如error-failed-to-update-core-unable-to-lock-database-的错误">#</a> 升级系统时出现形如<code>error: failed to update core (unable to lock database)</code>的错误</h3><p>可能存在升级系统时异常关机或程序异常退出的情况，移除 pacman 的 db 锁即可</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">rm</span> /var/lib/pacman/db.lck\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h3 id="手动开关混成器"><a class="header-anchor" href="#手动开关混成器">#</a> 手动开关混成器</h3>',10),h=(0,n.Uk)("有时混成器会因为某些原因需要手动开启或关闭，但是目前在 KDE 下混成器在设置里无法在不关机的情况下直接关闭，下面命令提供手动开关混成器的效果。"),m={href:"https://unix.stackexchange.com/questions/597736/disabling-kwin-compositor-from-command-line",target:"_blank",rel:"noopener noreferrer"},b=(0,n.Uk)("[1]"),g=(0,n.uE)('<div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>qdbus org.kde.KWin /Compositor <span class="token function">suspend</span>  <span class="token comment"># 禁用</span>\nqdbus org.kde.KWin /Compositor resume   <span class="token comment"># 开启</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div>',1),f={render:function(e,a){const s=(0,n.up)("OutboundLink");return(0,n.wg)(),(0,n.j4)(n.HY,null,[r,(0,n.Wm)("p",null,[o,(0,n.Wm)("a",l,[d,(0,n.Wm)(s)]),c,(0,n.Wm)("a",t,[i,(0,n.Wm)(s)]),u]),p,(0,n.Wm)("p",null,[h,(0,n.Wm)("a",m,[b,(0,n.Wm)(s)])]),g],64)}}}}]);