(self.webpackChunkarch_guide=self.webpackChunkarch_guide||[]).push([[543],{2464:(l,n,a)=>{"use strict";a.r(n),a.d(n,{data:()=>e});const e={key:"v-f6e31a70",path:"/rookie/transparent.html",title:"archlinux 透明代理",lang:"zh-CN",frontmatter:{},excerpt:"",headers:[{level:3,title:"🕊 纵使千山多万壑，犹有青鸾踏云间",slug:"🕊-纵使千山多万壑-犹有青鸾踏云间",children:[]},{level:3,title:"🔖 这一节将会讨论：",slug:"🔖-这一节将会讨论",children:[]},{level:2,title:"1. 安装 Qv2ray",slug:"_1-安装-qv2ray",children:[]},{level:2,title:"2. 配置 Qv2ray",slug:"_2-配置-qv2ray",children:[]},{level:2,title:"3. 配置订阅",slug:"_3-配置订阅",children:[]},{level:2,title:"4. 通过系统代理方式尝试连接",slug:"_4-通过系统代理方式尝试连接",children:[]},{level:2,title:"5. 安装 cgproxy",slug:"_5-安装-cgproxy",children:[]},{level:2,title:"6. 配置 Qv2ray 透明代理设置",slug:"_6-配置-qv2ray-透明代理设置",children:[]},{level:2,title:"7. 配置 cgproxy",slug:"_7-配置-cgproxy",children:[]}],filePathRelative:"rookie/transparent.md",git:{updatedTime:1623345656e3,contributors:[{name:"icekylin",email:"wminid@yeah.net",commits:1}]}}},8252:(l,n,a)=>{"use strict";a.r(n),a.d(n,{default:()=>xl});var e=a(6252);const m=a.p+"assets/img/transparent_qv2ray.80b15094.png",s=a.p+"assets/img/transparent_cfg-1.1590b34f.png",r=a.p+"assets/img/transparent_cfg-2.f0dc98a3.png",c=a.p+"assets/img/transparent_cfg-3.7038c9ec.png",u=a.p+"assets/img/transparent_cfg-4.3417c442.png",W=a.p+"assets/img/transparent_cfg-5.66bbb60f.png",t=a.p+"assets/img/transparent_cfg-6.9dcf2a3b.png",o=a.p+"assets/img/transparent_connect-1.0493ef28.png",i=a.p+"assets/img/transparent_connect-2.de57acb4.png",p=a.p+"assets/img/transparent_connect-3.1d2ba67a.png",d=a.p+"assets/img/transparent_transparent-qv2ray-1.bd67535d.png",g=a.p+"assets/img/transparent_transparent-qv2ray-2.8e81e767.png",k=(0,e.Wm)("h1",{id:"archlinux-透明代理"},[(0,e.Wm)("a",{class:"header-anchor",href:"#archlinux-透明代理"},"#"),(0,e.Uk)(" archlinux 透明代理")],-1),h=(0,e.Wm)("blockquote",null,[(0,e.Wm)("h3",{id:"🕊-纵使千山多万壑-犹有青鸾踏云间"},[(0,e.Wm)("a",{class:"header-anchor",href:"#🕊-纵使千山多万壑-犹有青鸾踏云间"},"#"),(0,e.Uk)(" 🕊 纵使千山多万壑，犹有青鸾踏云间")]),(0,e.Wm)("p",null,"全球化浪潮无法阻挡，我们常常有访问一些资料的客观需求。但有的时候因为一些因素往往导致无法正常访问。虽然前路千沟万壑，但无法阻挡我们前行的脚步。本节我们通过设置透明代理解决这一问题")],-1),U=(0,e.Wm)("blockquote",null,[(0,e.Wm)("h3",{id:"🔖-这一节将会讨论"},[(0,e.Wm)("a",{class:"header-anchor",href:"#🔖-这一节将会讨论"},"#"),(0,e.Uk)(" 🔖 这一节将会讨论：")]),(0,e.Wm)("ol",null,[(0,e.Wm)("li",null,"配置透明代理")])],-1),v=(0,e.Wm)("div",{class:"custom-container danger"},[(0,e.Wm)("p",{class:"custom-container-title"},"☢️ 警告"),(0,e.Wm)("p",null,[(0,e.Wm)("em",null,"第六条　计算机信息网络直接进行国际联网，必须使用邮电部国家公用电信网提供的国际出入口信道。")]),(0,e.Wm)("p",null,[(0,e.Wm)("em",null,"任何单位和个人不得自行建立或者使用其他信道进行国际联网。")]),(0,e.Wm)("p",null,"-- 中华人民共和国计算机信息网络国际联网管理暂行规定")],-1),y=(0,e.Wm)("h2",{id:"_1-安装-qv2ray"},[(0,e.Wm)("a",{class:"header-anchor",href:"#_1-安装-qv2ray"},"#"),(0,e.Uk)(" 1. 安装 Qv2ray")],-1),b=(0,e.Uk)("通过以下命令安装 "),f={href:"https://github.com/Qv2ray/Qv2ray",target:"_blank",rel:"noopener noreferrer"},_=(0,e.Uk)("Qv2ray"),x=(0,e.Wm)("sup",null,"cn",-1),Q=(0,e.Uk)(" 和 "),q={href:"https://archlinux.org/packages/?sort=&q=v2ray&maintainer=&flagged=",target:"_blank",rel:"noopener noreferrer"},R=(0,e.Uk)("V2Ray"),V=(0,e.Uk)(" 内核："),w=(0,e.Wm)("div",{class:"language-bash ext-sh line-numbers-mode"},[(0,e.Wm)("pre",{class:"language-bash"},[(0,e.Wm)("code",null,[(0,e.Wm)("span",{class:"token function"},"sudo"),(0,e.Uk)(" pacman -S qv2ray-dev-git v2ray\n")])]),(0,e.Wm)("div",{class:"line-numbers"},[(0,e.Wm)("span",{class:"line-number"},"1"),(0,e.Wm)("br")])],-1),S=(0,e.Wm)("div",{class:"custom-container tip"},[(0,e.Wm)("p",{class:"custom-container-title"},"ℹ️ 提示"),(0,e.Wm)("p",null,"若安装 V2Ray 核心时提示"),(0,e.Wm)("div",{class:"language-bash ext-sh line-numbers-mode"},[(0,e.Wm)("pre",{class:"language-bash"},[(0,e.Wm)("code",null,[(0,e.Wm)("span",{class:"token function"},"sudo"),(0,e.Uk)(" pacman -S xray\n")])]),(0,e.Wm)("div",{class:"line-numbers"},[(0,e.Wm)("span",{class:"line-number"},"1"),(0,e.Wm)("br")])])],-1),C=(0,e.Wm)("p",null,[(0,e.Wm)("img",{src:m,alt:"Qv2ray"})],-1),E=(0,e.Wm)("blockquote",null,[(0,e.Wm)("h4",{id:"📑-相关资料-qv2ray"},[(0,e.Wm)("a",{class:"header-anchor",href:"#📑-相关资料-qv2ray"},"#"),(0,e.Uk)(" 📑 相关资料：Qv2ray")]),(0,e.Wm)("p",null,"Qv2ray 是一个使用 Qt 编写的跨平台的 v2ray 图形前端。")],-1),G=(0,e.Wm)("div",{class:"custom-container tip"},[(0,e.Wm)("p",{class:"custom-container-title"},"ℹ️ 提示"),(0,e.Wm)("p",null,"可以使用 Xray 内核代替 V2Ray 内核"),(0,e.Wm)("div",{class:"language-bash ext-sh line-numbers-mode"},[(0,e.Wm)("pre",{class:"language-bash"},[(0,e.Wm)("code",null,[(0,e.Wm)("span",{class:"token function"},"sudo"),(0,e.Uk)(" pacman -S xray\n")])]),(0,e.Wm)("div",{class:"line-numbers"},[(0,e.Wm)("span",{class:"line-number"},"1"),(0,e.Wm)("br")])])],-1),I=(0,e.Wm)("h2",{id:"_2-配置-qv2ray"},[(0,e.Wm)("a",{class:"header-anchor",href:"#_2-配置-qv2ray"},"#"),(0,e.Uk)(" 2. 配置 Qv2ray")],-1),P=(0,e.Wm)("ol",null,[(0,e.Wm)("li",null,[(0,e.Uk)("打开 Qv2ray > 并转到 "),(0,e.Wm)("code",null,"首选项"),(0,e.Uk)(" 窗口：")])],-1),j=(0,e.Wm)("p",null,[(0,e.Wm)("img",{src:s,alt:"Qv2ray_config-1"})],-1),N=(0,e.Wm)("ol",{start:"2"},[(0,e.Wm)("li",null,[(0,e.Uk)("在 "),(0,e.Wm)("code",null,"内核设置"),(0,e.Uk)(" 中，点击 "),(0,e.Wm)("code",null,"检查 V2Ray 核心设置"),(0,e.Uk)(" 按钮以验证 V2Ray 核心设置：")])],-1),O=(0,e.Wm)("p",null,[(0,e.Wm)("img",{src:r,alt:"Qv2ray_config-2"})],-1),X=(0,e.Wm)("div",{class:"custom-container tip"},[(0,e.Wm)("p",{class:"custom-container-title"},"ℹ️ 提示"),(0,e.Wm)("ol",null,[(0,e.Wm)("li",null,[(0,e.Wm)("p",null,"若使用 Xray 内核，则先需修改："),(0,e.Wm)("ol",null,[(0,e.Wm)("li",null,[(0,e.Wm)("p",null,[(0,e.Wm)("code",null,"V2Ray 核心可执行文件路径"),(0,e.Uk)(" 为 "),(0,e.Wm)("code",null,"/usr/bin/xray")])]),(0,e.Wm)("li",null,[(0,e.Wm)("p",null,[(0,e.Wm)("code",null,"V2Ray 资源目录"),(0,e.Uk)(" 为 "),(0,e.Wm)("code",null,"/usr/share/xray")])])])]),(0,e.Wm)("li",null,[(0,e.Wm)("p",null,[(0,e.Uk)("再点击 "),(0,e.Wm)("code",null,"检查 V2Ray 核心设置"),(0,e.Uk)(" 按钮以验证 Xray 核心设置：")])])]),(0,e.Wm)("p",null,[(0,e.Wm)("img",{src:c,alt:"Qv2ray_config-3"})])],-1),z=(0,e.Wm)("h2",{id:"_3-配置订阅"},[(0,e.Wm)("a",{class:"header-anchor",href:"#_3-配置订阅"},"#"),(0,e.Uk)(" 3. 配置订阅")],-1),D=(0,e.Wm)("ol",null,[(0,e.Wm)("li",null,[(0,e.Uk)("在主窗口中点击 "),(0,e.Wm)("code",null,"分组"),(0,e.Uk)("：")])],-1),K=(0,e.Wm)("p",null,[(0,e.Wm)("img",{src:u,alt:"Qv2ray_config-4"})],-1),M=(0,e.Wm)("ol",{start:"2"},[(0,e.Wm)("li",null,[(0,e.Uk)("修改 "),(0,e.Wm)("code",null,"分组名称"),(0,e.Uk)(" 的 "),(0,e.Wm)("code",null,"默认分组"),(0,e.Uk)(" 为自定义名称，通常为 ✈ 场名称即可：")])],-1),H=(0,e.Wm)("p",null,[(0,e.Wm)("img",{src:W,alt:"Qv2ray_config-5"})],-1),L=(0,e.Wm)("ol",{start:"3"},[(0,e.Wm)("li",null,[(0,e.Wm)("p",null,[(0,e.Uk)("切换到 "),(0,e.Wm)("code",null,"订阅设置"),(0,e.Uk)(" 面板并进行如下配置：")]),(0,e.Wm)("ol",null,[(0,e.Wm)("li",null,[(0,e.Wm)("p",null,[(0,e.Uk)("勾选 "),(0,e.Wm)("code",null,"此组是一个订阅")])]),(0,e.Wm)("li",null,[(0,e.Wm)("p",null,[(0,e.Uk)("设置 "),(0,e.Wm)("code",null,"订阅地址"),(0,e.Uk)(" 为 ✈ 场提供的 "),(0,e.Wm)("code",null,"订阅链接")])]),(0,e.Wm)("li",null,[(0,e.Wm)("p",null,[(0,e.Uk)("点击 "),(0,e.Wm)("code",null,"更新订阅"),(0,e.Uk)(" 按钮并等待完成")])]),(0,e.Wm)("li",null,[(0,e.Wm)("p",null,[(0,e.Uk)("点击 "),(0,e.Wm)("code",null,"确定"),(0,e.Uk)(" 应用设置并关闭对话框")])])])])],-1),T=(0,e.Wm)("p",null,[(0,e.Wm)("img",{src:t,alt:"Qv2ray_config-6"})],-1),Y=(0,e.Wm)("div",{class:"custom-container tip"},[(0,e.Wm)("p",{class:"custom-container-title"},"ℹ️ 提示"),(0,e.Wm)("p",null,[(0,e.Uk)("若使用 "),(0,e.Wm)("code",null,"qv2ray-dev-git"),(0,e.Wm)("sup",null,"cn"),(0,e.Uk)("，则需要注意的是最新的 "),(0,e.Wm)("code",null,"qv2ray-dev-git"),(0,e.Uk)(" 已经将机场的默认订阅类型改为规范 "),(0,e.Wm)("code",null,"SIP008"),(0,e.Uk)("。")]),(0,e.Wm)("p",null,[(0,e.Uk)("如果你的 ✈ 场订阅类型为 "),(0,e.Wm)("code",null,"base64"),(0,e.Uk)("，则需要在 "),(0,e.Wm)("code",null,"订阅设置"),(0,e.Uk)(" 面板 > "),(0,e.Wm)("code",null,"订阅类型"),(0,e.Uk)(" 中，将 "),(0,e.Wm)("code",null,"SIP008"),(0,e.Uk)(" 改为 "),(0,e.Wm)("code",null,"base64"),(0,e.Uk)("，否则你将拿不到订阅链接中的任何节点。")])],-1),A=(0,e.Wm)("h2",{id:"_4-通过系统代理方式尝试连接"},[(0,e.Wm)("a",{class:"header-anchor",href:"#_4-通过系统代理方式尝试连接"},"#"),(0,e.Uk)(" 4. 通过系统代理方式尝试连接")],-1),B=(0,e.Wm)("ol",null,[(0,e.Wm)("li",null,[(0,e.Uk)("双击分组中添加的订阅即可查看更新出的节点，右键点击 "),(0,e.Wm)("code",null,"测试延迟"),(0,e.Uk)(" 可以测试分组或节点的延迟：")])],-1),F=(0,e.Wm)("p",null,[(0,e.Wm)("img",{src:o,alt:"Qv2ray_connect-1"})],-1),J=(0,e.Wm)("ol",{start:"2"},[(0,e.Wm)("li",null,[(0,e.Uk)("右键点击需要连接的节点 > 点击 "),(0,e.Wm)("code",null,"连接到此服务器"),(0,e.Uk)(" 即可连接：")])],-1),Z=(0,e.Wm)("p",null,[(0,e.Wm)("img",{src:i,alt:"Qv2ray_connect-2"})],-1),$=(0,e.Wm)("ol",{start:"3"},[(0,e.Wm)("li",null,"打开不存在的网站验证连接：")],-1),ll=(0,e.Wm)("p",null,[(0,e.Wm)("img",{src:p,alt:"Qv2ray_connect-3"})],-1),nl=(0,e.Wm)("div",{class:"custom-container tip"},[(0,e.Wm)("p",{class:"custom-container-title"},"ℹ️ 提示"),(0,e.Wm)("p",null,[(0,e.Uk)("Qv2ray 会自动配置系统代理。也可以点击托盘图标 > 在弹出菜单中，依次选择 "),(0,e.Wm)("code",null,"系统代理"),(0,e.Uk)(" > "),(0,e.Wm)("code",null,"启用 / 禁用系统代理"),(0,e.Uk)(" 以启用或禁用系统代理。")])],-1),al=(0,e.Wm)("div",{class:"custom-container tip"},[(0,e.Wm)("p",{class:"custom-container-title"},"ℹ️ 提示"),(0,e.Wm)("p",null,"GNOME 的系统代理设置非常有效。这是因为 GNOME 的系统代理设置得到了普遍的适配。"),(0,e.Wm)("p",null,"但是 KDE 的系统代理设置更像是一个玩具。甚至 KDE 系列应用程序本身也不会读取和使用那个配置。所以我们需要通过设置透明代理的方式解决这个问题。"),(0,e.Wm)("p",null,"同时这也可以使终端下的应用使用代理连接（如 git）。")],-1),el=(0,e.Wm)("h2",{id:"_5-安装-cgproxy"},[(0,e.Wm)("a",{class:"header-anchor",href:"#_5-安装-cgproxy"},"#"),(0,e.Uk)(" 5. 安装 cgproxy")],-1),ml=(0,e.Uk)("通过以下命令安装 "),sl={href:"https://github.com/springzfx/cgproxy",target:"_blank",rel:"noopener noreferrer"},rl=(0,e.Uk)("cgproxy"),cl=(0,e.Wm)("sup",null,"cn / aur",-1),ul=(0,e.Uk)("："),Wl=(0,e.Wm)("div",{class:"language-bash ext-sh line-numbers-mode"},[(0,e.Wm)("pre",{class:"language-bash"},[(0,e.Wm)("code",null,[(0,e.Wm)("span",{class:"token function"},"sudo"),(0,e.Uk)(" pacman -S cgproxy-git\n")])]),(0,e.Wm)("div",{class:"line-numbers"},[(0,e.Wm)("span",{class:"line-number"},"1"),(0,e.Wm)("br")])],-1),tl=(0,e.Wm)("div",{class:"language-bash ext-sh line-numbers-mode"},[(0,e.Wm)("pre",{class:"language-bash"},[(0,e.Wm)("code",null,"yay -S aur/cgproxy\n")]),(0,e.Wm)("div",{class:"line-numbers"},[(0,e.Wm)("span",{class:"line-number"},"1"),(0,e.Wm)("br")])],-1),ol=(0,e.Wm)("h2",{id:"_6-配置-qv2ray-透明代理设置"},[(0,e.Wm)("a",{class:"header-anchor",href:"#_6-配置-qv2ray-透明代理设置"},"#"),(0,e.Uk)(" 6. 配置 Qv2ray 透明代理设置")],-1),il=(0,e.Wm)("ol",null,[(0,e.Wm)("li",null,[(0,e.Uk)("打开 Qv2ray > "),(0,e.Wm)("code",null,"首选项"),(0,e.Uk)(" > "),(0,e.Wm)("code",null,"入站设置"),(0,e.Uk)(" > 取消勾选 "),(0,e.Wm)("code",null,"设置系统代理"),(0,e.Uk)("：")])],-1),pl=(0,e.Wm)("p",null,[(0,e.Wm)("img",{src:d,alt:"Qv2ray_transparent-1"})],-1),dl=(0,e.Wm)("ol",{start:"2"},[(0,e.Wm)("li",null,[(0,e.Uk)("勾选 "),(0,e.Wm)("code",null,"透明代理设置"),(0,e.Uk)("：")])],-1),gl=(0,e.Wm)("p",null,[(0,e.Wm)("img",{src:g,alt:"Qv2ray_transparent-2"})],-1),kl=(0,e.Wm)("p",null,[(0,e.Uk)("其它设置保持默认即可，"),(0,e.Wm)("code",null,"IPv4 端口"),(0,e.Uk)(" 可自定义为其它端口。")],-1),hl=(0,e.Wm)("ol",{start:"3"},[(0,e.Wm)("li",null,[(0,e.Uk)("点击 "),(0,e.Wm)("code",null,"确定"),(0,e.Uk)(" 保存设置")])],-1),Ul=(0,e.Wm)("h2",{id:"_7-配置-cgproxy"},[(0,e.Wm)("a",{class:"header-anchor",href:"#_7-配置-cgproxy"},"#"),(0,e.Uk)(" 7. 配置 cgproxy")],-1),vl=(0,e.Wm)("ol",null,[(0,e.Wm)("li",null,[(0,e.Uk)("通过 "),(0,e.Wm)("code",null,"vim"),(0,e.Uk)(" 编辑 "),(0,e.Wm)("code",null,"/etc/cgproxy/config.json"),(0,e.Uk)(" 文件：")])],-1),yl=(0,e.Wm)("div",{class:"language-bash ext-sh line-numbers-mode"},[(0,e.Wm)("pre",{class:"language-bash"},[(0,e.Wm)("code",null,[(0,e.Wm)("span",{class:"token function"},"sudo"),(0,e.Uk)(),(0,e.Wm)("span",{class:"token function"},"vim"),(0,e.Uk)(" /etc/cgproxy/config.json\n")])]),(0,e.Wm)("div",{class:"line-numbers"},[(0,e.Wm)("span",{class:"line-number"},"1"),(0,e.Wm)("br")])],-1),bl=(0,e.Wm)("p",null,"进行如下修改：",-1),fl=(0,e.Wm)("ul",null,[(0,e.Wm)("li",null,[(0,e.Uk)("在 "),(0,e.Wm)("code",null,"cgroup_proxy"),(0,e.Uk)(" 中括号里加上 "),(0,e.Wm)("code",null,'"/"'),(0,e.Uk)("（包含引号）")]),(0,e.Wm)("li",null,[(0,e.Wm)("code",null,"port"),(0,e.Uk)(" 改为 Qv2ray 首选项里的透明代理的端口")]),(0,e.Wm)("li")],-1),_l=(0,e.Wm)("div",{class:"custom-container tip"},[(0,e.Wm)("p",{class:"custom-container-title"},"ℹ️ 提示"),(0,e.Wm)("p",null,[(0,e.Uk)("cgproxy 默认配置是代理所有 "),(0,e.Wm)("code",null,"tcp"),(0,e.Uk)(" 和 "),(0,e.Wm)("code",null,"udp"),(0,e.Uk)("；"),(0,e.Wm)("code",null,"ipv4"),(0,e.Uk)(" 和 "),(0,e.Wm)("code",null,"ipv6"),(0,e.Uk)(" 的流量。")]),(0,e.Wm)("p",null,[(0,e.Uk)("如果不希望代理其中的某种（些）流量，则将对应的 "),(0,e.Wm)("code",null,"enable_xxx"),(0,e.Uk)(" 改为 "),(0,e.Wm)("code",null,"false"),(0,e.Uk)("。注意，这里的配置要和 Qv2ray 选项里的配置一致（例如 Qv2ray 选项里没有勾选 "),(0,e.Wm)("code",null,"udp"),(0,e.Uk)("，则这里务必把 "),(0,e.Wm)("code",null,"enable_udp"),(0,e.Uk)(" 改为 "),(0,e.Wm)("code",null,"false"),(0,e.Uk)("）")])],-1),xl={render:function(l,n){const a=(0,e.up)("OutboundLink"),m=(0,e.up)("CodeGroupItem"),s=(0,e.up)("CodeGroup");return(0,e.wg)(),(0,e.j4)(e.HY,null,[k,h,U,v,y,(0,e.Wm)("p",null,[b,(0,e.Wm)("a",f,[_,(0,e.Wm)(a)]),x,Q,(0,e.Wm)("a",q,[R,(0,e.Wm)(a)]),V]),w,S,C,E,G,I,P,j,N,O,X,z,D,K,M,H,L,T,Y,A,B,F,J,Z,$,ll,nl,al,el,(0,e.Wm)("p",null,[ml,(0,e.Wm)("a",sl,[rl,(0,e.Wm)(a)]),cl,ul]),(0,e.Wm)(s,null,{default:(0,e.w5)((()=>[(0,e.Wm)(m,{title:"cn"},{default:(0,e.w5)((()=>[Wl])),_:1}),(0,e.Wm)(m,{title:"aur"},{default:(0,e.w5)((()=>[tl])),_:1})])),_:1}),ol,il,pl,dl,gl,kl,hl,Ul,vl,yl,bl,fl,_l],64)}}}}]);